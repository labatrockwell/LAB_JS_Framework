<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: sound/WAPlayer.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: sound/WAPlayer.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/** @namespace LAB.sound*/
LAB.sound = LAB.sound || {};

LAB.require(LAB.src+"geom/Point.js");

// creates global audio context if there isn't one yet
LAB.require(LAB.src+"sound/AudioContext.js");

/** 
 Web Audio Player
 Web Audio must be enabled in Chrome via about:flags!
 @constructor 
 */
LAB.sound.WAPlayer = function( ){//loop, autoplay, controls ){		
	LAB.EventDispatcher.call( this, this );
	
	this.buffer = null;
	this.pan	= new LAB.geom.Point();
	this.pitch	= 0;
	this.gain	= 0;
	
	this.filter = null;
	
	this.currentSource 	= null;
	this.currentTime	= 0;
	
	this.panner			= LAB.sound.Context.createPanner();
	this.panner.setPosition(0,0,0);
	
	this.start 	= 0;
	this.end	= 0;
}

// METHODS

LAB.sound.WAPlayer.prototype.loadFile 		= function( url )
{	
	//this.registerEvents();
	var request = new XMLHttpRequest();
	request.parent = this;
    request.open("GET", url, false);
    request.responseType = "arraybuffer";
	request.parent = this;
	
    request.onload = function() { 
        request.parent.buffer = LAB.sound.Context.createBuffer(request.response, true);
		request.parent.end = Math.floor(request.parent.buffer.duration);
    }

    request.send();	
}

LAB.sound.WAPlayer.prototype.setFilter	= function( filter )
{
	this.filter = filter;
}

// PLAYBACK METHODS

LAB.sound.WAPlayer.prototype.play	= function(){
	//this.source.noteOff(0);
	var source 					= LAB.sound.Context.createBufferSource();	
	source.playbackRate.value 	= this.pitch;
	source.gain					= this.gain;
	source.buffer 				= this.buffer;
	
	if (this.filter != null){
		source.connect(this.filter);
		this.filter.connect(this.panner);
	}  else {
		source.connect(this.panner);
	}
	
	this.panner.connect(LAB.sound.Context.destination);
	source.noteGrainOn(0, this.start, this.end);
}

LAB.sound.WAPlayer.prototype.setGain	= function(gain){
	this.gain = gain;
}

LAB.sound.WAPlayer.prototype.setPan	= function(x, y, z){
	this.pan.x = x;
	this.pan.y = y || this.pan.y;
	this.pan.z = z || this.pan.z;
	this.panner.setPosition(this.pan.x, this.pan.y, this.pan.z);
}

LAB.sound.WAPlayer.prototype.setPitch	= function(pitch){
	this.pitch = Math.pow(2.0, pitch / 1200.0);
};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="LAB.html">LAB</a></li><li><a href="LAB.agents.Agent.html">Agent</a></li><li><a href="LAB.agents.Behavior.html">Behavior</a></li><li><a href="LAB.agents.Group.html">Group</a></li><li><a href="LAB.app.BaseApp.html">BaseApp</a></li><li><a href="LAB.app.ThreeApp.html">ThreeApp</a></li><li><a href="LAB.Event.html">Event</a></li><li><a href="LAB.geom.Point.html">Point</a></li><li><a href="LAB.geom.Rect.html">Rect</a></li><li><a href="LAB.sound.Player.html">Player</a></li><li><a href="LAB.sound.WAPlayer.html">WAPlayer</a></li><li><a href="LAB.three.html">three</a></li><li><a href="LAB.three.Camera.html">Camera</a></li><li><a href="LAB.three.Geometry.html">Geometry</a></li><li><a href="LAB.three.Mesh.html">Mesh</a></li><li><a href="LAB.three.Object.html">Object</a></li><li><a href="LAB.three.Ray.html">Ray</a></li><li><a href="LAB.three.Shader.html">Shader</a></li><li><a href="LAB.utils.html">utils</a></li><li><a href="LAB.utils.WebSocket.html">WebSocket</a></li></ul><h3>Namespaces</h3><ul><li><a href="LAB.agents.html">agents</a></li><li><a href="LAB.app.html">app</a></li><li><a href="LAB.geom.html">geom</a></li><li><a href="LAB.sound.html">sound</a></li></ul><h3>Global</h3><ul><li><a href="global.html#gl">gl</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.0-dev</a> on Mon Jan 28 2013 10:33:35 GMT-0500 (EST)
</footer>

<script> prettyPrint(); </script>
</body>
</html>
